local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/memejames/elerium-v2-ui-library//main/Library", true))()

local window = library:AddWindow("Test", {
    main_color = Color3.fromRGB(41, 74, 122),
    min_size = Vector2.new(650, 600),
    can_resize = false,
})

local Killing = window:AddTab("Killing")

-- Whitelist Dropdown
local whitelist = {}
local whitelistDropdown = Killing:AddDropdown("Whitelist", function(playerName)
    table.insert(whitelist, playerName)
end)

for _, player in ipairs(game.Players:GetPlayers()) do
    if player.Name ~= game.Players.LocalPlayer.Name then
        whitelistDropdown:Add(player.Name)
    end
end

-- Auto Kill Toggle (Fixed)
local autoKillRunning = false
local autoKillToggle = Killing:AddSwitch("Auto Kill", function(state)
    autoKillRunning = state  -- Update the running state

    if state then
        task.spawn(function()
            while autoKillRunning do
                local player = game.Players.LocalPlayer
                local punchTool = player.Backpack:FindFirstChild("Punch") or player.Character:FindFirstChild("Punch")

                if not punchTool then
                    punchTool = game.ReplicatedStorage:FindFirstChild("Punch"):Clone()
                    if punchTool then punchTool.Parent = player.Backpack end
                end

                game.Players.LocalPlayer.muscleEvent:FireServer("punch", "rightHand")
                game.Players.LocalPlayer.muscleEvent:FireServer("punch", "leftHand")

                for _, targetPlayer in pairs(game.Players:GetPlayers()) do
                    if targetPlayer ~= player and not table.find(whitelist, targetPlayer.Name) then
                        local targetCharacter = targetPlayer.Character
                        if targetCharacter and targetCharacter:FindFirstChild("HumanoidRootPart") then
                            local touchPart = targetCharacter.HumanoidRootPart
                            firetouchinterest(player.Character.RightHand, touchPart, 0)
                            firetouchinterest(player.Character.LeftHand, touchPart, 0)
                            wait(0.1)
                            firetouchinterest(player.Character.RightHand, touchPart, 1)
                            firetouchinterest(player.Character.LeftHand, touchPart, 1)
                        end
                    end
                end
                wait(0.1)
            end
        end)
    end
end)

-- Select Target Dropdown
local selectedTargetName = nil
local selectTargetDropdown = Killing:AddDropdown("Select Target", function(playerName)
    selectedTargetName = playerName
end)

for _, player in ipairs(game.Players:GetPlayers()) do
    if player.Name ~= game.Players.LocalPlayer.Name then
        selectTargetDropdown:Add(player.Name)
    end
end

-- Kill Target Toggle (Fixed)
local killTargetRunning = false
local killTargetToggle = Killing:AddSwitch("Kill Target", function(state)
    killTargetRunning = state  -- Update the running state

    if state then
        task.spawn(function()
            while killTargetRunning and selectedTargetName do
                local player = game.Players.LocalPlayer
                local punchTool = player.Backpack:FindFirstChild("Punch") or player.Character:FindFirstChild("Punch")

                if not punchTool then
                    punchTool = game.ReplicatedStorage:FindFirstChild("Punch"):Clone()
                    if punchTool then punchTool.Parent = player.Backpack end
                end

                game.Players.LocalPlayer.muscleEvent:FireServer("punch", "rightHand")
                game.Players.LocalPlayer.muscleEvent:FireServer("punch", "leftHand")

                local targetPlayer = game.Players:FindFirstChild(selectedTargetName)
                if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
                    local touchPart = targetPlayer.Character.HumanoidRootPart
                    firetouchinterest(player.Character.RightHand, touchPart, 0)
                    firetouchinterest(player.Character.LeftHand, touchPart, 0)
                    wait(0.1)
                    firetouchinterest(player.Character.RightHand, touchPart, 1)
                    firetouchinterest(player.Character.LeftHand, touchPart, 1)
                end
                wait(0.1)
            end
        end)
    end
end)

-- Auto Punch [No Animation] Toggle
local autoPunchToggle = Killing:AddSwitch("Auto Punch [No Animation]", function(state)
    _G.autoPunchanim = state

    if state then
        task.spawn(function()
            local player = game.Players.LocalPlayer
            local punchTool = player.Backpack:FindFirstChild("Punch") or player.Character:FindFirstChild("Punch")

            while _G.autoPunchanim do
                if punchTool then
                    if punchTool.Parent ~= player.Character then
                        punchTool.Parent = player.Character -- Equip the tool
                    end
                    game.Players.LocalPlayer.muscleEvent:FireServer("punch", "rightHand")
                    game.Players.LocalPlayer.muscleEvent:FireServer("punch", "leftHand")
                    wait(0.1)
                else
                    warn("Punch tool not found")
                    _G.autoPunchanim = false
                end
            end
        end)
    end
end)
